<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ADHD自测量表 - React版</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // 测试题目数据
      const testData = {
        children: [
          // SNAP-IV 注意力不集中症状 (1-9)
          {
            text: "经常在学习、工作或其他活动中不注意细节或因粗心大意而出错",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "在任务或游戏活动中经常难以保持注意",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "别人和他说话时，经常显得没有在听",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常不按指示完成学校作业、家务或工作职责（不是由于对立行为或不理解指示）",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常难以组织任务和活动",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常回避、不喜欢或不愿从事需要持续动脑的任务（如学校作业或家庭作业）",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常遗失任务或活动所需的东西（如玩具、学校作业、铅笔、书或工具）",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常容易被外在刺激转移注意力",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "在日常活动中经常健忘",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          // SNAP-IV 多动-冲动症状 (10-18)
          {
            text: "经常手脚动个不停或坐着时扭来扭去",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "在应该坐着的场合经常离开座位",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常在不合适的场合跑来跑去或爬高爬低（在青少年或成人可能只是坐立不安的感觉）",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常无法安静地参与游戏或休闲活动",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常'忙个不停'或'像装了发动机似的'行动",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常说话过多",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常在问题没说完时就抢着回答",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常难以等候轮流",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "经常打断或干扰别人（如插嘴或打断别人的游戏）",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
        ],
        adult: [
          // 注意力不集中症状
          {
            text: "我很难专注于工作或任务的细节，经常出现粗心的错误",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我很难在工作或娱乐活动中保持注意力",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当有人直接对我说话时，我似乎没有在听",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我经常无法完成工作、家务或其他职责",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我在组织任务和活动方面有困难",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我避免、不喜欢或不愿意进行需要持续精神努力的任务",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我经常遗失工作或活动所需的物品",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我容易被外界刺激分散注意力",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我在日常活动中经常健忘",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          // 多动冲动症状
          {
            text: "我在座位上坐立不安，摆弄手脚",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "在需要保持坐着的情况下，我感到不安或想要起来走动",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我感到过度活跃和被驱使去做事情",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我很难安静地参加休闲活动或娱乐活动",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我说话过多",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "问题还没问完，我就脱口说出答案",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我很难等待轮到自己",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我经常打断或干扰别人",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "我很难放松和冷静下来",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
        ],
      };

      // 主应用组件
      function ADHDTestApp() {
        const [currentPage, setCurrentPage] = useState("home");
        const [testType, setTestType] = useState(null);
        const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
        const [answers, setAnswers] = useState([]);
        const [results, setResults] = useState(null);

        const startTest = (type) => {
          setTestType(type);
          setCurrentQuestionIndex(0);
          setAnswers(new Array(testData[type].length).fill(null));
          setCurrentPage("test");
        };

        const selectAnswer = (value) => {
          const newAnswers = [...answers];
          newAnswers[currentQuestionIndex] = value;
          setAnswers(newAnswers);
        };

        const nextQuestion = () => {
          if (currentQuestionIndex < testData[testType].length - 1) {
            setCurrentQuestionIndex(currentQuestionIndex + 1);
          }
        };

        const previousQuestion = () => {
          if (currentQuestionIndex > 0) {
            setCurrentQuestionIndex(currentQuestionIndex - 1);
          }
        };

        const calculateResults = () => {
          const questions = testData[testType];
          let inattentionScore = 0;
          let hyperactivityScore = 0;

          questions.forEach((question, index) => {
            const score = answers[index] || 0;
            if (question.type === "inattention") {
              inattentionScore += score;
            } else {
              hyperactivityScore += score;
            }
          });

          const totalScore = inattentionScore + hyperactivityScore;
          const maxScore = testType === "children" ? 54 : 72;
          const maxInattentionScore = testType === "children" ? 27 : 36;
          const maxHyperactivityScore = testType === "children" ? 27 : 36;

          setResults({
            total: totalScore,
            inattention: inattentionScore,
            hyperactivity: hyperactivityScore,
            maxScore,
            maxInattentionScore,
            maxHyperactivityScore,
          });
          setCurrentPage("results");
        };

        const resetTest = () => {
          setCurrentPage("home");
          setTestType(null);
          setCurrentQuestionIndex(0);
          setAnswers([]);
          setResults(null);
        };

        if (currentPage === "home") {
          return <HomePage onStartTest={startTest} />;
        } else if (currentPage === "test") {
          return (
            <TestPage
              testType={testType}
              questions={testData[testType]}
              currentQuestionIndex={currentQuestionIndex}
              answers={answers}
              onSelectAnswer={selectAnswer}
              onNextQuestion={nextQuestion}
              onPreviousQuestion={previousQuestion}
              onSubmitTest={calculateResults}
              onBackToHome={resetTest}
            />
          );
        } else if (currentPage === "results") {
          return (
            <ResultsPage
              testType={testType}
              results={results}
              onRetakeTest={resetTest}
            />
          );
        }
      }

      // 首页组件
      function HomePage({ onStartTest }) {
        return (
          <div className="container">
            <div className="page active">
              <div className="hero">
                <div className="hero-content">
                  <h1 className="hero-title">ADHD自测量表</h1>
                  <p className="hero-subtitle">
                    基于国际标准医学量表，提供专业的ADHD初步筛查
                  </p>
                  <div className="disclaimer">
                    <p>
                      <strong>重要声明：</strong>
                      本测试仅用于初步筛查，不能替代专业医学诊断。如有疑虑，请咨询专业医生。
                    </p>
                  </div>
                </div>
              </div>

              <div className="test-selection">
                <h2>请选择适合的测试版本</h2>
                <div className="test-cards">
                  <div
                    className="test-card"
                    onClick={() => onStartTest("children")}
                  >
                    <div className="card-icon">👶</div>
                    <h3>儿童版</h3>
                    <p>适用年龄：6-18岁</p>
                    <p className="card-description">
                      基于SNAP-IV量表，包含18个DSM-5标准ADHD症状评估项目
                    </p>
                    <button className="btn-primary">开始测试</button>
                  </div>

                  <div
                    className="test-card"
                    onClick={() => onStartTest("adult")}
                  >
                    <div className="card-icon">👤</div>
                    <h3>成人版</h3>
                    <p>适用年龄：18岁以上</p>
                    <p className="card-description">
                      基于成人ADHD自评量表(ASRS)，评估成年期ADHD症状
                    </p>
                    <button className="btn-primary">开始测试</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 测试页面组件
      function TestPage({
        testType,
        questions,
        currentQuestionIndex,
        answers,
        onSelectAnswer,
        onNextQuestion,
        onPreviousQuestion,
        onSubmitTest,
        onBackToHome,
      }) {
        const currentQuestion = questions[currentQuestionIndex];
        const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
        const isLastQuestion = currentQuestionIndex === questions.length - 1;
        const hasAnswer =
          answers[currentQuestionIndex] !== null &&
          answers[currentQuestionIndex] !== undefined;
        const allAnswered = answers.every(
          (answer) => answer !== null && answer !== undefined
        );

        return (
          <div className="container">
            <div className="page active">
              <div className="test-header">
                <button className="btn-back" onClick={onBackToHome}>
                  ← 返回首页
                </button>
                <div className="progress-container">
                  <div className="progress-bar">
                    <div
                      className="progress-fill"
                      style={{ width: `${progress}%` }}
                    ></div>
                  </div>
                  <span className="progress-text">
                    {currentQuestionIndex + 1} / {questions.length}
                  </span>
                </div>
              </div>

              <div className="test-content">
                <div className="question-card">
                  <div className="question-number">
                    问题 <span>{currentQuestionIndex + 1}</span>
                  </div>
                  <h2 className="question-text">{currentQuestion.text}</h2>
                  <div className="answer-options">
                    {currentQuestion.options.map((option, index) => (
                      <div
                        key={index}
                        className={`answer-option ${
                          answers[currentQuestionIndex] === option.value
                            ? "selected"
                            : ""
                        }`}
                        onClick={() => onSelectAnswer(option.value)}
                      >
                        <input
                          type="radio"
                          name="answer"
                          value={option.value}
                          checked={
                            answers[currentQuestionIndex] === option.value
                          }
                          onChange={() => {}}
                        />
                        <label>{option.text}</label>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="test-navigation">
                  <button
                    className="btn-secondary"
                    onClick={onPreviousQuestion}
                    disabled={currentQuestionIndex === 0}
                  >
                    上一题
                  </button>
                  {isLastQuestion ? (
                    <button
                      className="btn-primary"
                      onClick={onSubmitTest}
                      disabled={!allAnswered}
                    >
                      查看结果
                    </button>
                  ) : (
                    <button
                      className="btn-primary"
                      onClick={onNextQuestion}
                      disabled={!hasAnswer}
                    >
                      下一题
                    </button>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 结果页面组件
      function ResultsPage({ testType, results, onRetakeTest }) {
        const {
          total,
          inattention,
          hyperactivity,
          maxScore,
          maxInattentionScore,
          maxHyperactivityScore,
        } = results;

        // 计算分析结果
        const analysis = getResultAnalysis(testType, results);
        const scoreInterpretation = getScoreInterpretation(
          testType,
          total,
          maxScore
        );
        const personalizedAnalysis = getPersonalizedAnalysis(testType, results);

        const inattentionPercentage = (inattention / maxInattentionScore) * 100;
        const hyperactivityPercentage =
          (hyperactivity / maxHyperactivityScore) * 100;

        return (
          <div className="container">
            <div className="page active">
              <div className="result-header">
                <button className="btn-back" onClick={onRetakeTest}>
                  ← 重新测试
                </button>
              </div>

              <div className="result-content">
                <div className="result-card">
                  <div className="result-score">
                    <div className="score-card">
                      <div className="score-label">测试总分</div>
                      <div className="score-main">
                        <span className="current-score">{total}</span>
                        <span className="score-separator">/</span>
                        <span className="max-score">{maxScore}</span>
                      </div>
                      <div className="score-percentage">
                        {Math.round((total / maxScore) * 100)}%
                      </div>
                    </div>
                  </div>

                  <div className="result-level">
                    <h2 className="level-title">{analysis.level}</h2>
                    <p className="level-description">{analysis.description}</p>
                  </div>

                  <div className="result-details">
                    <h3>详细分析</h3>

                    <div className="score-interpretation">
                      <h4>分数解读</h4>
                      <div
                        className="interpretation-content"
                        dangerouslySetInnerHTML={{
                          __html: scoreInterpretation,
                        }}
                      ></div>
                    </div>

                    <div className="symptom-analysis">
                      <div className="symptom-category">
                        <h4>注意力不集中症状</h4>
                        <div className="symptom-score">
                          <span className="score-display">
                            {inattention} / {maxInattentionScore} 分
                          </span>
                          <div className="score-bar">
                            <div
                              className="score-fill"
                              style={{ width: `${inattentionPercentage}%` }}
                            ></div>
                          </div>
                        </div>
                        <div className="symptom-interpretation">
                          得分 {Math.round(inattentionPercentage)}%
                          {inattentionPercentage <= 30
                            ? "，注意力集中能力良好，很少出现注意力分散的问题。"
                            : inattentionPercentage <= 60
                            ? "，存在轻到中度的注意力问题，在某些情况下可能难以集中注意力。"
                            : "，注意力问题较为严重，经常出现注意力不集中、容易分心的情况。"}
                        </div>
                      </div>

                      <div className="symptom-category">
                        <h4>多动冲动症状</h4>
                        <div className="symptom-score">
                          <span className="score-display">
                            {hyperactivity} / {maxHyperactivityScore} 分
                          </span>
                          <div className="score-bar">
                            <div
                              className="score-fill"
                              style={{ width: `${hyperactivityPercentage}%` }}
                            ></div>
                          </div>
                        </div>
                        <div className="symptom-interpretation">
                          得分 {Math.round(hyperactivityPercentage)}%
                          {hyperactivityPercentage <= 30
                            ? "，行为控制能力良好，很少出现冲动或过度活跃的行为。"
                            : hyperactivityPercentage <= 60
                            ? "，存在轻到中度的冲动控制问题，有时可能表现出坐立不安或冲动行为。"
                            : "，冲动控制问题较为严重，经常表现出多动、冲动或难以安静的行为。"}
                        </div>
                      </div>
                    </div>

                    <div className="personalized-analysis">
                      <h4>个性化分析</h4>
                      <div
                        className="personalized-content"
                        dangerouslySetInnerHTML={{
                          __html: personalizedAnalysis,
                        }}
                      ></div>
                    </div>

                    <div className="recommendations">
                      <h4>专业建议</h4>
                      <div
                        className="recommendation-content"
                        dangerouslySetInnerHTML={{
                          __html: analysis.recommendations,
                        }}
                      ></div>
                    </div>
                  </div>

                  <div className="result-actions">
                    <button className="btn-primary" onClick={onRetakeTest}>
                      重新测试
                    </button>
                    <button
                      className="btn-secondary"
                      onClick={() => window.print()}
                    >
                      保存结果
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 分析函数
      function getResultAnalysis(testType, scores) {
        const { total } = scores;

        if (testType === "children") {
          if (total <= 18) {
            if (testType === "children") {
          // SNAP-IV标准：注意力不集中或多动-冲动得分≥12分（相当于6个症状×2分）提示阳性
          const { inattention, hyperactivity } = scores;
          const hasInattentionSymptoms = inattention >= 12;
          const hasHyperactivitySymptoms = hyperactivity >= 12;
          
          if (!hasInattentionSymptoms && !hasHyperactivitySymptoms) {
            return {
              level: "低风险",
              description:
                "根据SNAP-IV评估标准，当前症状表现不显著，ADHD的可能性较低。孩子的注意力和行为控制能力基本正常。",
              recommendations: `
                            <ul>
                                <li>继续保持良好的学习和生活习惯</li>
                                <li>适当增加体育锻炼和户外活动</li>
                                <li>建立规律的作息时间</li>
                                <li>鼓励孩子参与需要专注的活动，如阅读、拼图等</li>
                                <li>定期关注孩子的学习和行为表现</li>
                            </ul>
                        `,
            };
          } else if (hasInattentionSymptoms || hasHyperactivitySymptoms) {
            return {
              level: "高风险",
              description:
                `根据SNAP-IV评估标准，检测到显著的ADHD症状。${hasInattentionSymptoms ? '注意力不集中症状明显' : ''}${hasInattentionSymptoms && hasHyperactivitySymptoms ? '，' : ''}${hasHyperactivitySymptoms ? '多动-冲动症状明显' : ''}。强烈建议咨询专业医生进行进一步评估。`,
              recommendations: `
                            <ul>
                                <li><strong>请尽快咨询儿童精神科医生或发育行为科医生</strong></li>
                                <li>准备详细的症状记录和学校反馈</li>
                                <li>考虑进行全面的ADHD诊断评估</li>
                                <li>收集来自多个环境（家庭、学校）的行为观察</li>
                                <li>了解学校的特殊教育资源和支持服务</li>
                                <li>建立结构化的日常routine和行为管理策略</li>
                            </ul>
                        `,
            };
          }
          } else if (total <= 36) {
            return {
              level: "中等风险",
              description:
                "存在一定程度的注意力或行为控制问题，建议密切关注孩子的表现，可考虑咨询专业医生。",
              recommendations: `
                            <ul>
                                <li><strong>建议咨询儿童心理医生或发育行为科医生</strong></li>
                                <li>建立更加结构化的日常routine</li>
                                <li>使用明确的指令和视觉提示</li>
                                <li>提供安静、无干扰的学习环境</li>
                                <li>适当分解复杂任务，给予及时的正面反馈</li>
                                <li>与学校老师保持密切沟通</li>
                            </ul>
                        `,
            };
          } else {
            return {
              level: "高风险",
              description:
                "症状表现明显，强烈建议尽快咨询专业医生进行进一步评估和诊断。",
              recommendations: `
                            <ul>
                                <li><strong>请尽快咨询儿童精神科医生或发育行为科医生</strong></li>
                                <li>准备详细的症状记录和学校反馈</li>
                                <li>考虑多学科评估（医生、心理师、教师联合评估）</li>
                                <li>了解学校的特殊教育资源和支持服务</li>
                                <li>学习ADHD相关知识，为可能的治疗做好准备</li>
                                <li>保持耐心和理解，避免过度批评孩子</li>
                            </ul>
                        `,
            };
          }
        } else {
          if (total <= 24) {
            return {
              level: "低风险",
              description:
                "当前症状表现较轻微，成人ADHD的可能性较低。您的注意力和冲动控制能力基本正常。",
              recommendations: `
                            <ul>
                                <li>保持良好的工作和生活习惯</li>
                                <li>使用时间管理工具提高效率</li>
                                <li>定期进行体育锻炼缓解压力</li>
                                <li>保证充足的睡眠和合理的营养</li>
                            </ul>
                        `,
            };
          } else if (total <= 48) {
            return {
              level: "中等风险",
              description:
                "存在一定程度的注意力缺陷或冲动控制问题，建议关注这些症状对日常生活的影响，可考虑咨询专业医生。",
              recommendations: `
                            <ul>
                                <li><strong>建议咨询精神科医生或心理医生</strong></li>
                                <li>使用任务管理App和提醒工具</li>
                                <li>创建无干扰的工作环境</li>
                                <li>学习正念冥想和放松技巧</li>
                                <li>建立规律的日常作息</li>
                                <li>与家人朋友分享您的困扰，获得支持</li>
                            </ul>
                        `,
            };
          } else {
            return {
              level: "高风险",
              description:
                "症状表现明显，强烈建议咨询专业医生进行全面评估。成人ADHD如果得到适当治疗，可以显著改善生活质量。",
              recommendations: `
                            <ul>
                                <li><strong>请尽快咨询精神科医生进行专业评估</strong></li>
                                <li>准备详细的症状历史和功能影响记录</li>
                                <li>了解成人ADHD的治疗选项（药物和非药物治疗）</li>
                                <li>考虑认知行为治疗(CBT)等心理治疗</li>
                                <li>寻找ADHD支持小组或在线社区</li>
                                <li>学习ADHD管理策略和生活技能</li>
                                <li>向雇主了解工作场所的合理调整政策</li>
                            </ul>
                        `,
            };
          }
        }
      }

      function getScoreInterpretation(testType, total, maxScore) {
        const percentage = Math.round((total / maxScore) * 100);

        let interpretation = `<p><strong>您的总分为 ${total} 分（满分 ${maxScore} 分），占总分的 ${percentage}%</strong></p>`;

        if (testType === "children") {
          interpretation += `
                    <div class="score-ranges">
                        <div class="score-range ${
                          total <= 18 ? "current" : ""
                        }">
                            <span class="range">0-18分</span>
                            <span class="level low-risk">低风险</span>
                            <span class="desc">症状轻微，ADHD可能性较低</span>
                        </div>
                        <div class="score-range ${
                          total > 18 && total <= 36 ? "current" : ""
                        }">
                            <span class="range">19-36分</span>
                            <span class="level medium-risk">中等风险</span>
                            <span class="desc">存在明显症状，建议专业评估</span>
                        </div>
                        <div class="score-range ${total > 36 ? "current" : ""}">
                            <span class="range">37-54分</span>
                            <span class="level high-risk">高风险</span>
                            <span class="desc">症状显著，强烈建议就医</span>
                        </div>
                    </div>
                `;
        } else {
          interpretation += `
                    <div class="score-ranges">
                        <div class="score-range ${
                          total <= 24 ? "current" : ""
                        }">
                            <span class="range">0-24分</span>
                            <span class="level low-risk">低风险</span>
                            <span class="desc">症状轻微，ADHD可能性较低</span>
                        </div>
                        <div class="score-range ${
                          total > 24 && total <= 48 ? "current" : ""
                        }">
                            <span class="range">25-48分</span>
                            <span class="level medium-risk">中等风险</span>
                            <span class="desc">存在明显症状，建议专业评估</span>
                        </div>
                        <div class="score-range ${total > 48 ? "current" : ""}">
                            <span class="range">49-72分</span>
                            <span class="level high-risk">高风险</span>
                            <span class="desc">症状显著，强烈建议就医</span>
                        </div>
                    </div>
                `;
        }

        return interpretation;
      }

      function getPersonalizedAnalysis(testType, scores) {
        const { total, inattention, hyperactivity } = scores;
        const testSubject = testType === "children" ? "孩子" : "您";

        let analysis = [];

        // 基于SNAP-IV标准的症状类型分析
        const inattentionThreshold = testType === "children" ? 12 : 16; // 儿童6症状×2分，成人8症状×2分
        const hyperactivityThreshold = testType === "children" ? 12 : 16;
        
        const hasInattentionSymptoms = inattention >= inattentionThreshold;
        const hasHyperactivitySymptoms = hyperactivity >= hyperactivityThreshold;

        if (hasInattentionSymptoms && hasHyperactivitySymptoms) {
          analysis.push(
            `根据SNAP-IV评估，${testSubject}同时表现出<span class="highlight">注意力不集中</span>和<span class="highlight">多动-冲动</span>症状，符合ADHD混合型的特征。`
          );
        } else if (hasInattentionSymptoms) {
          analysis.push(
            `根据SNAP-IV评估，${testSubject}主要表现为<span class="highlight">注意力不集中型</span>ADHD症状，包括难以集中注意力、容易分心、健忘等问题。`
          );
        } else if (hasHyperactivitySymptoms) {
          analysis.push(
            `根据SNAP-IV评估，${testSubject}主要表现为<span class="highlight">多动-冲动型</span>ADHD症状，包括坐立不安、冲动行为、难以安静等问题。`
          );
        } else {
          analysis.push(
            `根据SNAP-IV评估，${testSubject}的症状尚未达到ADHD诊断阈值，但仍需要<span class="highlight">持续观察</span>。`
          );
        }

        // 症状严重程度分析
        if (hasInattentionSymptoms || hasHyperactivitySymptoms) {
          const percentage = Math.round((total / (testType === "children" ? 54 : 72)) * 100);
          analysis.push(
            `症状严重程度为<span class="highlight">${percentage}%</span>，已达到需要专业评估的标准。建议进行全面的临床评估以确定诊断和制定治疗方案。`
          );
        } else {
          analysis.push(
            `当前症状表现<span class="highlight">较轻</span>，但仍需保持关注。`
          );
        }

        // 功能影响评估
        if (testType === "adult") {
          if (total > 36) {
            analysis.push(
              `这些症状很可能已经对您的工作、学习或人际关系造成了<span class="highlight">显著影响</span>。`
            );
          } else if (total > 18) {
            analysis.push(
              `这些症状可能在某些情况下对您的日常生活造成<span class="highlight">一定影响</span>。`
            );
          }
        } else {
          if (total > 36) {
            analysis.push(
              `这些症状很可能已经对孩子的学习、社交或家庭生活造成了<span class="highlight">显著影响</span>。`
            );
          } else if (total > 18) {
            analysis.push(
              `这些症状可能在某些情况下对孩子的日常生活造成<span class="highlight">一定影响</span>。`
            );
          }
        }

        return analysis.join("<br><br>");
      }

      // 渲染应用
      ReactDOM.render(<ADHDTestApp />, document.getElementById("root"));
    </script>
  </body>
</html>
