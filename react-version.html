<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ADHD自测量表 - React版</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // 测试题目数据
      const testData = {
        children: [
          // 注意力不集中症状 (1-9)
          {
            text: "孩子在学习、工作或其他活动中，经常无法注意到细节或因粗心而犯错",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子在做功课或游戏时，经常难以保持注意力",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "别人对孩子说话时，孩子经常看起来没在听",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子经常不能按照指令完成功课、家务或工作职责",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子经常在组织任务和活动方面有困难",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子经常回避、不喜欢或不愿意参加需要持续精神努力的任务",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子经常遗失任务或活动所需的物品",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子经常容易被外界刺激分散注意力",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          {
            text: "孩子在日常活动中经常健忘",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "偶尔", value: 1 },
              { text: "经常", value: 2 },
              { text: "总是", value: 3 },
            ],
          },
          // 多动冲动症状 (10-18)
          // 多动冲动症状
          {
            text: "身体总是闲不下来，想要动一动",
            example: "手指敲桌子、脚抖、转笔、玩头发，就是坐不住",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "在应该坐着的场合总想起来走动",
            example: "开会中途想出去、在电影院或飞机上坐不住",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "内心总感觉焦躁不安，像有个马达在转",
            example: "哪怕外表看起来安静，内心总是忙个不停，想东想西",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "参加需要安静的活动时总忍不住制造点声音或动静",
            example: "看电影时窃窃私语、图书馆里弄出响声",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "说话比别人多，经常滔滔不绝",
            example: "一开口就停不下来，明明想简单说几句却说了一大堆",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "别人还没说完就抢着回答",
            example: "听到关键词就急着插话，经常答非所问或理解错意思",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "排队或等待时总是很不耐烦",
            example: "排队买东西、等电梯、等红绿灯时焦虑急躁",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "经常打断别人说话或插入别人的活动",
            example: "别人聊天时插嘴、不敲门就进办公室、打断别人工作",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "做决定时很冲动，事后经常后悔",
            example: "冲动购物、冲动辞职、冲动决定去旅游，之后发现不合适",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },,
        ],
        adult: [
          {
            text: "当一件事情的难点都做完后常常拖着不去收尾",
            example: "论文写完正文却懒得修改格式、工作汇报做完不想整理PPT，最后那一点总是拖。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当面对需要系统规划或组织的任务时经常感到困难或混乱，理不清头绪",
            example: "打算收拾房间、准备出行或做项目计划，却不知道从哪开始，越整理越乱。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "经常忘记约好的事或该做的事",
            example: "忘了开会、忘了交作业、朋友约了吃饭结果想不起来。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "面对需要动脑子的任务时总想拖一拖",
            example: "要写报告、写论文或整理账目时，总想着\"等一下再开始\"。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当需要坐很久时老是动来动去",
            example: "开会、上课、看电影时，不自觉抖腿、玩笔、摸手机。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "觉得自己\"停不下来\"，像被马达驱动一样",
            example: "一闲下来就焦虑，坐着也要找点事做，比如反复刷手机、收拾东西。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当事情又难又无聊时容易粗心犯错",
            example: "填表漏写一项、Excel 输错数字、看题看串行。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "做重复或枯燥的事时注意力容易飘走",
            example: "看文档、听会议、整理数据，做到一半脑子就\"神游\"了。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "别人当面直接跟你说话时经常走神，听不进去",
            example: "对方讲了一堆，最后才发现自己一个字都没听进去。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "经常找不到自己的东西",
            example: "钥匙、手机、耳机、文件经常不见，最后在奇怪的地方找到。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "周围有人在动或有声音时会被打断注意力",
            example: "有人聊天、外面有车声、手机亮了一下，就立刻分心。",
            type: "inattention",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "在需要坐着的场合中（如开会、课堂），常忍不住站起来或移动",
            example: "上课或会议中途，突然很想出去走走或换个姿势。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "常常觉得自己坐不住、心里慌慌的",
            example: "就算没什么事，也觉得不自在、总想动一动。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当你终于有空闲时间时反而觉得放松不下来？",
            example: "周末想躺平，却又焦虑、刷手机、胡思乱想停不下来。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "在聊天或社交场合中不知不觉说太多",
            example: "聊天时抢话题、讲得比别人多，后来还会反思会不会说太多。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "别人还没说完就忍不住接他们的话",
            example: "总想抢话、替别人补句，以为自己知道他要说啥。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "在需要排队或轮流的场合常觉得等待很难受",
            example: "打游戏排队、等待发言、排队结账时觉得等不下去。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
          {
            text: "当别人正忙时会不由自主地打断他们",
            example: "对方在工作、写东西、打电话，你还是忍不住想插话或问问题。",
            type: "hyperactivity",
            options: [
              { text: "从不", value: 0 },
              { text: "很少", value: 1 },
              { text: "有时", value: 2 },
              { text: "经常", value: 3 },
              { text: "总是", value: 4 },
            ],
          },
        ],
      };

      // 主应用组件
      function ADHDTestApp() {
        const [currentPage, setCurrentPage] = useState("home");
        const [testType, setTestType] = useState(null);
        const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
        const [answers, setAnswers] = useState([]);
        const [results, setResults] = useState(null);

        const startTest = (type) => {
          setTestType(type);
          setCurrentQuestionIndex(0);
          setAnswers(new Array(testData[type].length).fill(null));
          setCurrentPage("test");
        };

        const selectAnswer = (value) => {
          const newAnswers = [...answers];
          newAnswers[currentQuestionIndex] = value;
          setAnswers(newAnswers);
        };

        const nextQuestion = () => {
          if (currentQuestionIndex < testData[testType].length - 1) {
            setCurrentQuestionIndex(currentQuestionIndex + 1);
          }
        };

        const previousQuestion = () => {
          if (currentQuestionIndex > 0) {
            setCurrentQuestionIndex(currentQuestionIndex - 1);
          }
        };

        const calculateResults = () => {
          const questions = testData[testType];
          let inattentionScore = 0;
          let hyperactivityScore = 0;

          questions.forEach((question, index) => {
            const score = answers[index] || 0;
            if (question.type === "inattention") {
              inattentionScore += score;
            } else {
              hyperactivityScore += score;
            }
          });

          const totalScore = inattentionScore + hyperactivityScore;
          const maxScore = testType === "children" ? 54 : 72;
          const maxInattentionScore = testType === "children" ? 27 : 36;
          const maxHyperactivityScore = testType === "children" ? 27 : 36;

          setResults({
            total: totalScore,
            inattention: inattentionScore,
            hyperactivity: hyperactivityScore,
            maxScore,
            maxInattentionScore,
            maxHyperactivityScore,
          });
          setCurrentPage("results");
        };

        const resetTest = () => {
          setCurrentPage("home");
          setTestType(null);
          setCurrentQuestionIndex(0);
          setAnswers([]);
          setResults(null);
        };

        if (currentPage === "home") {
          return <HomePage onStartTest={startTest} />;
        } else if (currentPage === "test") {
          return (
            <TestPage
              testType={testType}
              questions={testData[testType]}
              currentQuestionIndex={currentQuestionIndex}
              answers={answers}
              onSelectAnswer={selectAnswer}
              onNextQuestion={nextQuestion}
              onPreviousQuestion={previousQuestion}
              onSubmitTest={calculateResults}
              onBackToHome={resetTest}
            />
          );
        } else if (currentPage === "results") {
          return (
            <ResultsPage
              testType={testType}
              results={results}
              onRetakeTest={resetTest}
            />
          );
        }
      }

      // 首页组件
      function HomePage({ onStartTest }) {
        return (
          <div className="container">
            <div className="page active">
              <div className="hero">
                <div className="hero-content">
                  <h1 className="hero-title">ADHD自测量表</h1>
                  <p className="hero-subtitle">
                    基于国际标准医学量表，提供专业的ADHD初步筛查
                  </p>
                  <div className="disclaimer">
                    <p>
                      <strong>重要声明：</strong>
                      本测试仅用于初步筛查，不能替代专业医学诊断。如有疑虑，请咨询专业医生。
                    </p>
                  </div>
                </div>
              </div>

              <div className="test-selection">
                <h2>请选择适合的测试版本</h2>
                <div className="test-cards">
                  <div
                    className="test-card"
                    onClick={() => onStartTest("children")}
                  >
                    <div className="card-icon">👶</div>
                    <h3>儿童版</h3>
                    <p>适用年龄：6-18岁</p>
                    <p className="card-description">
                      基于ADHD-RS量表，包含18个核心症状评估项目
                    </p>
                    <button className="btn-primary">开始测试</button>
                  </div>

                  <div
                    className="test-card"
                    onClick={() => onStartTest("adult")}
                  >
                    <div className="card-icon">👤</div>
                    <h3>成人版</h3>
                    <p>适用年龄：18岁以上</p>
                    <p className="card-description">
                      基于成人ADHD自评量表(ASRS)，评估成年期ADHD症状
                    </p>
                    <button className="btn-primary">开始测试</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 测试页面组件
      function TestPage({
        testType,
        questions,
        currentQuestionIndex,
        answers,
        onSelectAnswer,
        onNextQuestion,
        onPreviousQuestion,
        onSubmitTest,
        onBackToHome,
      }) {
        const currentQuestion = questions[currentQuestionIndex];
        const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
        const isLastQuestion = currentQuestionIndex === questions.length - 1;
        const hasAnswer =
          answers[currentQuestionIndex] !== null &&
          answers[currentQuestionIndex] !== undefined;
        const allAnswered = answers.every(
          (answer) => answer !== null && answer !== undefined
        );

        return (
          <div className="container">
            <div className="page active">
              <div className="test-header">
                <button className="btn-back" onClick={onBackToHome}>
                  ← 返回首页
                </button>
                <div className="progress-container">
                  <div className="progress-bar">
                    <div
                      className="progress-fill"
                      style={{ width: `${progress}%` }}
                    ></div>
                  </div>
                  <span className="progress-text">
                    {currentQuestionIndex + 1} / {questions.length}
                  </span>
                </div>
              </div>

              <div className="test-content">
                <div className="question-card">
                  <div className="question-number">
                    问题 <span>{currentQuestionIndex + 1}</span>
                  </div>
                  <h2 className="question-text">{currentQuestion.text}</h2>
                  {currentQuestion.example && (
                    <div className="question-example">
                      <span className="example-label">例如：</span>
                      {currentQuestion.example}
                    </div>
                  )}
                  <div className="answer-options">
                    {currentQuestion.options.map((option, index) => (
                      <div
                        key={index}
                        className={`answer-option ${
                          answers[currentQuestionIndex] === option.value
                            ? "selected"
                            : ""
                        }`}
                        onClick={() => onSelectAnswer(option.value)}
                      >
                        <input
                          type="radio"
                          name="answer"
                          value={option.value}
                          checked={
                            answers[currentQuestionIndex] === option.value
                          }
                          onChange={() => {}}
                        />
                        <label>{option.text}</label>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="test-navigation">
                  <button
                    className="btn-secondary"
                    onClick={onPreviousQuestion}
                    disabled={currentQuestionIndex === 0}
                  >
                    上一题
                  </button>
                  {isLastQuestion ? (
                    <button
                      className="btn-primary"
                      onClick={onSubmitTest}
                      disabled={!allAnswered}
                    >
                      查看结果
                    </button>
                  ) : (
                    <button
                      className="btn-primary"
                      onClick={onNextQuestion}
                      disabled={!hasAnswer}
                    >
                      下一题
                    </button>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 结果页面组件
      function ResultsPage({ testType, results, onRetakeTest }) {
        const {
          total,
          inattention,
          hyperactivity,
          maxScore,
          maxInattentionScore,
          maxHyperactivityScore,
        } = results;

        // 计算分析结果
        const analysis = getResultAnalysis(testType, results);
        const scoreInterpretation = getScoreInterpretation(
          testType,
          total,
          maxScore
        );
        const personalizedAnalysis = getPersonalizedAnalysis(testType, results);

        const inattentionPercentage = (inattention / maxInattentionScore) * 100;
        const hyperactivityPercentage =
          (hyperactivity / maxHyperactivityScore) * 100;

        return (
          <div className="container">
            <div className="page active">
              <div className="result-header">
                <button className="btn-back" onClick={onRetakeTest}>
                  ← 重新测试
                </button>
              </div>

              <div className="result-content">
                <div className="result-card">
                  <div className="result-score">
                    <div className="score-card">
                      <div className="score-label">测试总分</div>
                      <div className="score-main">
                        <span className="current-score">{total}</span>
                        <span className="score-separator">/</span>
                        <span className="max-score">{maxScore}</span>
                      </div>
                      <div className="score-percentage">
                        {Math.round((total / maxScore) * 100)}%
                      </div>
                    </div>
                  </div>

                  <div className="result-level">
                    <h2 className="level-title">{analysis.level}</h2>
                    <p className="level-description">{analysis.description}</p>
                  </div>

                  <div className="result-details">
                    <h3>详细分析</h3>

                    <div className="score-interpretation">
                      <h4>分数解读</h4>
                      <div
                        className="interpretation-content"
                        dangerouslySetInnerHTML={{
                          __html: scoreInterpretation,
                        }}
                      ></div>
                    </div>

                    <div className="symptom-analysis">
                      <div className="symptom-category">
                        <h4>注意力不集中症状</h4>
                        <div className="symptom-score">
                          <span className="score-display">
                            {inattention} / {maxInattentionScore} 分
                          </span>
                          <div className="score-bar">
                            <div
                              className="score-fill"
                              style={{ width: `${inattentionPercentage}%` }}
                            ></div>
                          </div>
                        </div>
                        <div className="symptom-interpretation">
                          得分 {Math.round(inattentionPercentage)}%
                          {inattentionPercentage <= 30
                            ? "，注意力集中能力良好，很少出现注意力分散的问题。"
                            : inattentionPercentage <= 60
                            ? "，存在轻到中度的注意力问题，在某些情况下可能难以集中注意力。"
                            : "，注意力问题较为严重，经常出现注意力不集中、容易分心的情况。"}
                        </div>
                      </div>

                      <div className="symptom-category">
                        <h4>多动冲动症状</h4>
                        <div className="symptom-score">
                          <span className="score-display">
                            {hyperactivity} / {maxHyperactivityScore} 分
                          </span>
                          <div className="score-bar">
                            <div
                              className="score-fill"
                              style={{ width: `${hyperactivityPercentage}%` }}
                            ></div>
                          </div>
                        </div>
                        <div className="symptom-interpretation">
                          得分 {Math.round(hyperactivityPercentage)}%
                          {hyperactivityPercentage <= 30
                            ? "，行为控制能力良好，很少出现冲动或过度活跃的行为。"
                            : hyperactivityPercentage <= 60
                            ? "，存在轻到中度的冲动控制问题，有时可能表现出坐立不安或冲动行为。"
                            : "，冲动控制问题较为严重，经常表现出多动、冲动或难以安静的行为。"}
                        </div>
                      </div>
                    </div>

                    <div className="personalized-analysis">
                      <h4>个性化分析</h4>
                      <div
                        className="personalized-content"
                        dangerouslySetInnerHTML={{
                          __html: personalizedAnalysis,
                        }}
                      ></div>
                    </div>

                    <div className="recommendations">
                      <h4>专业建议</h4>
                      <div
                        className="recommendation-content"
                        dangerouslySetInnerHTML={{
                          __html: analysis.recommendations,
                        }}
                      ></div>
                    </div>
                  </div>

                  <div className="result-actions">
                    <button className="btn-primary" onClick={onRetakeTest}>
                      重新测试
                    </button>
                    <button
                      className="btn-secondary"
                      onClick={() => window.print()}
                    >
                      保存结果
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // 分析函数
      function getResultAnalysis(testType, scores) {
        const { total } = scores;

        if (testType === "children") {
          if (total <= 18) {
            return {
              level: "低风险",
              description:
                "当前症状表现较轻微，ADHD的可能性较低。孩子的注意力和行为控制能力基本正常。",
              recommendations: `
                            <ul>
                                <li>继续保持良好的学习和生活习惯</li>
                                <li>适当增加体育锻炼和户外活动</li>
                                <li>建立规律的作息时间</li>
                                <li>鼓励孩子参与需要专注的活动，如阅读、拼图等</li>
                            </ul>
                        `,
            };
          } else if (total <= 36) {
            return {
              level: "中等风险",
              description:
                "存在一定程度的注意力或行为控制问题，建议密切关注孩子的表现，可考虑咨询专业医生。",
              recommendations: `
                            <ul>
                                <li><strong>建议咨询儿童心理医生或发育行为科医生</strong></li>
                                <li>建立更加结构化的日常routine</li>
                                <li>使用明确的指令和视觉提示</li>
                                <li>提供安静、无干扰的学习环境</li>
                                <li>适当分解复杂任务，给予及时的正面反馈</li>
                                <li>与学校老师保持密切沟通</li>
                            </ul>
                        `,
            };
          } else {
            return {
              level: "高风险",
              description:
                "症状表现明显，强烈建议尽快咨询专业医生进行进一步评估和诊断。",
              recommendations: `
                            <ul>
                                <li><strong>请尽快咨询儿童精神科医生或发育行为科医生</strong></li>
                                <li>准备详细的症状记录和学校反馈</li>
                                <li>考虑多学科评估（医生、心理师、教师联合评估）</li>
                                <li>了解学校的特殊教育资源和支持服务</li>
                                <li>学习ADHD相关知识，为可能的治疗做好准备</li>
                                <li>保持耐心和理解，避免过度批评孩子</li>
                            </ul>
                        `,
            };
          }
        } else {
          if (total <= 24) {
            return {
              level: "低风险",
              description:
                "当前症状表现较轻微，成人ADHD的可能性较低。您的注意力和冲动控制能力基本正常。",
              recommendations: `
                            <ul>
                                <li>保持良好的工作和生活习惯</li>
                                <li>使用时间管理工具提高效率</li>
                                <li>定期进行体育锻炼缓解压力</li>
                                <li>保证充足的睡眠和合理的营养</li>
                            </ul>
                        `,
            };
          } else if (total <= 48) {
            return {
              level: "中等风险",
              description:
                "存在一定程度的注意力缺陷或冲动控制问题，建议关注这些症状对日常生活的影响，可考虑咨询专业医生。",
              recommendations: `
                            <ul>
                                <li><strong>建议咨询精神科医生或心理医生</strong></li>
                                <li>使用任务管理App和提醒工具</li>
                                <li>创建无干扰的工作环境</li>
                                <li>学习正念冥想和放松技巧</li>
                                <li>建立规律的日常作息</li>
                                <li>与家人朋友分享您的困扰，获得支持</li>
                            </ul>
                        `,
            };
          } else {
            return {
              level: "高风险",
              description:
                "症状表现明显，强烈建议咨询专业医生进行全面评估。成人ADHD如果得到适当治疗，可以显著改善生活质量。",
              recommendations: `
                            <ul>
                                <li><strong>请尽快咨询精神科医生进行专业评估</strong></li>
                                <li>准备详细的症状历史和功能影响记录</li>
                                <li>了解成人ADHD的治疗选项（药物和非药物治疗）</li>
                                <li>考虑认知行为治疗(CBT)等心理治疗</li>
                                <li>寻找ADHD支持小组或在线社区</li>
                                <li>学习ADHD管理策略和生活技能</li>
                                <li>向雇主了解工作场所的合理调整政策</li>
                            </ul>
                        `,
            };
          }
        }
      }

      function getScoreInterpretation(testType, total, maxScore) {
        const percentage = Math.round((total / maxScore) * 100);

        let interpretation = `<p><strong>您的总分为 ${total} 分（满分 ${maxScore} 分），占总分的 ${percentage}%</strong></p>`;

        if (testType === "children") {
          interpretation += `
                    <div class="score-ranges">
                        <div class="score-range ${
                          total <= 18 ? "current" : ""
                        }">
                            <span class="range">0-18分</span>
                            <span class="level low-risk">低风险</span>
                            <span class="desc">症状轻微，ADHD可能性较低</span>
                        </div>
                        <div class="score-range ${
                          total > 18 && total <= 36 ? "current" : ""
                        }">
                            <span class="range">19-36分</span>
                            <span class="level medium-risk">中等风险</span>
                            <span class="desc">存在明显症状，建议专业评估</span>
                        </div>
                        <div class="score-range ${total > 36 ? "current" : ""}">
                            <span class="range">37-54分</span>
                            <span class="level high-risk">高风险</span>
                            <span class="desc">症状显著，强烈建议就医</span>
                        </div>
                    </div>
                `;
        } else {
          interpretation += `
                    <div class="score-ranges">
                        <div class="score-range ${
                          total <= 24 ? "current" : ""
                        }">
                            <span class="range">0-24分</span>
                            <span class="level low-risk">低风险</span>
                            <span class="desc">症状轻微，ADHD可能性较低</span>
                        </div>
                        <div class="score-range ${
                          total > 24 && total <= 48 ? "current" : ""
                        }">
                            <span class="range">25-48分</span>
                            <span class="level medium-risk">中等风险</span>
                            <span class="desc">存在明显症状，建议专业评估</span>
                        </div>
                        <div class="score-range ${total > 48 ? "current" : ""}">
                            <span class="range">49-72分</span>
                            <span class="level high-risk">高风险</span>
                            <span class="desc">症状显著，强烈建议就医</span>
                        </div>
                    </div>
                `;
        }

        return interpretation;
      }

      function getPersonalizedAnalysis(testType, scores) {
        const { total, inattention, hyperactivity } = scores;
        const testSubject = testType === "children" ? "孩子" : "您";

        let analysis = [];

        // 症状类型分析
        if (inattention > hyperactivity) {
          const diff = inattention - hyperactivity;
          if (diff >= 6) {
            analysis.push(
              `<span class="highlight">注意力不集中</span>是主要表现，${testSubject}更多地表现为难以集中注意力、容易分心、健忘等问题。`
            );
          } else {
            analysis.push(
              `${testSubject}的注意力问题和多动冲动问题都有所表现，但<span class="highlight">注意力不集中</span>稍微突出一些。`
            );
          }
        } else if (hyperactivity > inattention) {
          const diff = hyperactivity - inattention;
          if (diff >= 6) {
            analysis.push(
              `<span class="highlight">多动冲动</span>是主要表现，${testSubject}更多地表现为坐立不安、冲动行为、难以安静等问题。`
            );
          } else {
            analysis.push(
              `${testSubject}的注意力问题和多动冲动问题都有所表现，但<span class="highlight">多动冲动</span>稍微突出一些。`
            );
          }
        } else {
          analysis.push(
            `${testSubject}在注意力不集中和多动冲动两方面的表现<span class="highlight">相对均衡</span>，两类症状并存。`
          );
        }

        // 严重程度分析
        if (total >= (testType === "children" ? 42 : 60)) {
          analysis.push(
            `症状表现<span class="highlight">非常明显</span>，已经达到需要专业医疗干预的程度。`
          );
        } else if (total >= (testType === "children" ? 30 : 40)) {
          analysis.push(
            `症状表现<span class="highlight">比较明显</span>，建议寻求专业医生的评估和建议。`
          );
        } else if (total >= (testType === "children" ? 18 : 24)) {
          analysis.push(
            `症状表现<span class="highlight">轻度到中度</span>，需要关注并采取相应的管理措施。`
          );
        } else {
          analysis.push(
            `当前症状表现<span class="highlight">较轻</span>，但仍需保持关注。`
          );
        }

        // 功能影响评估
        if (testType === "adult") {
          if (total > 36) {
            analysis.push(
              `这些症状很可能已经对您的工作、学习或人际关系造成了<span class="highlight">显著影响</span>。`
            );
          } else if (total > 18) {
            analysis.push(
              `这些症状可能在某些情况下对您的日常生活造成<span class="highlight">一定影响</span>。`
            );
          }
        } else {
          if (total > 36) {
            analysis.push(
              `这些症状很可能已经对孩子的学习、社交或家庭生活造成了<span class="highlight">显著影响</span>。`
            );
          } else if (total > 18) {
            analysis.push(
              `这些症状可能在某些情况下对孩子的日常生活造成<span class="highlight">一定影响</span>。`
            );
          }
        }

        return analysis.join("<br><br>");
      }

      // 渲染应用
      ReactDOM.render(<ADHDTestApp />, document.getElementById("root"));
    </script>
  </body>
</html>
